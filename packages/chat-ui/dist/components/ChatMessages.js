import{jsx as e,jsxs as o}from"react/jsx-runtime";import{useRef as t,useState as r,useEffect as i,useCallback as n,useMemo as l,useLayoutEffect as s}from"react";import{Flex as c,Stack as a,Text as d,Icon as h,SkeletonCircle as g,Skeleton as p}from"@chakra-ui/react";import{sleep as u}from"@strata-foundation/spl-utils";import m from"lodash/throttle";import{useAsyncCallback as f}from"react-async-hook";import{MemodMessage as v}from"./message/Message.js";const w=()=>o(c,Object.assign({padding:2,gap:2},{children:[e(c,{children:e(g,{size:"9"},void 0)},void 0),o(c,Object.assign({grow:1,direction:"column",gap:2},{children:[o(c,Object.assign({gap:2},{children:[e(p,{height:"8px",w:"120px"},void 0),e(p,{height:"8px",w:"60px"},void 0)]}),void 0),e(p,{height:"8px",w:"full"},void 0),e(p,{height:"8px",w:"full"},void 0)]}),void 0)]}),void 0),x="undefined"!=typeof window?s:i,y=({isLoading:s,isLoadingMore:g,hasMore:p,fetchMore:y=(()=>null),scrollRef:b,messages:j=[]})=>{const k=t(null);b||(b=k);const O=j.length>0,[I,H]=r(!0);i((()=>{b.current.scrollHeight==b.current.offsetHeight&&p&&!s&&y(50)}),[b,p,s,y]);const z=n(m((e=>{e.target.scrollHeight+e.target.scrollTop<=e.target.offsetHeight+300&&!g&&p&&y(50),H(e.target.scrollTop>-50)}),300),[g,y,p,H]),M=l((()=>j.length?e(w,{},void 0):Array.from(Array(50).keys()).map(((o,t)=>e(w,{},`skeleton-${t}`)))),[j.length]),{execute:S}=f((async function(e){let o=!1;function t(e){"Escape"===e.key&&(o=!0)}for(document.addEventListener("keypress",t);!o&&p&&b.current;){let o=document.getElementById(e);if(o)return void o.scrollIntoView({behavior:"smooth",block:"center"});b.current.scroll({top:-b.current.scrollHeight,behavior:"smooth"}),await u(300)}document.removeEventListener("keypress",t)})),T=t(null);return x((()=>{I&&T.current?.scrollIntoView({behavior:"smooth",block:"center"})}),[j,I]),o(c,Object.assign({grow:1,overflowY:"auto",direction:"column-reverse",ref:b,onScroll:z},{children:[e("div",{ref:T,style:{height:"0px"},id:"scroll-anchor"},void 0),!s&&j?.map(((o,t)=>e(v,Object.assign({scrollToMessage:S},o,{showUser:!(j[t+1]&&j[t+1].sender.equals(o.sender)&&j[t+1].endBlockTime>=(o.startBlockTime||(new Date).valueOf()/1e3)-60&&!o.reply)}),o?.id))),(s||g)&&M,!(s||g)&&!O&&o(a,Object.assign({w:"full",h:"full",justifyContent:"center",alignItems:"center",gap:0,spacing:0,position:"relative",lineHeight:9},{children:[e(d,Object.assign({fontSize:"3xl",zIndex:"1"},{children:"Its Quiet In Here"}),void 0),e(d,Object.assign({fontSize:"3xl",color:"primary.500",zIndex:"1"},{children:"Say Something"}),void 0),e(h,Object.assign({width:"100%",height:"50%",viewBox:"0 0 578 440",fill:"none",xmlns:"http://www.w3.org/2000/svg",color:"gray.800",position:"absolute"},{children:e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M239.184 439.443c-55.13-5.419-110.241-21.365-151.074-58.767C42.307 338.722-7.478 282.729.938 221.217c8.433-61.644 78.896-91.048 126.871-130.712 34.337-28.388 70.198-51.348 112.004-66.78C282.34 8.024 325.382-3.369 370.518.904c54.019 5.115 112.774 10.886 150.881 49.482 39.916 40.427 49.421 100.753 53.385 157.402 4.13 59.015 11.255 128.44-30.444 170.44-41.383 41.683-111.6 19.106-169.213 30.663-46.68 9.364-88.56 35.21-135.943 30.551z",fill:"currentColor"},void 0)}),void 0)]}),void 0)]}),void 0)};export{w as ChatMessageSkeleton,y as ChatMessages};
//# sourceMappingURL=ChatMessages.js.map
