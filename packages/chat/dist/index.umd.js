!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@metaplex-foundation/mpl-token-metadata"),require("@cardinal/namespaces"),require("@cocalc/local-storage-lru"),require("@project-serum/anchor"),require("@solana/spl-token"),require("@solana/web3.js"),require("@strata-foundation/spl-utils"),require("@strata-foundation/spl-token-bonding"),require("bn.js"),require("bs58"),require("lit-js-sdk"),require("uuid"),require("tweetnacl"),require("util"),require("uint8arrays"),require("@orca-so/sdk"),require("@shadow-drive/sdk"),require("decimal.js")):"function"==typeof define&&define.amd?define(["exports","@metaplex-foundation/mpl-token-metadata","@cardinal/namespaces","@cocalc/local-storage-lru","@project-serum/anchor","@solana/spl-token","@solana/web3.js","@strata-foundation/spl-utils","@strata-foundation/spl-token-bonding","bn.js","bs58","lit-js-sdk","uuid","tweetnacl","util","uint8arrays","@orca-so/sdk","@shadow-drive/sdk","decimal.js"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Chat={},e.mplTokenMetadata,e.namespaces,e.localStorageLru,e.anchor,e.splToken,e.web3_js,e.splUtils,e.splTokenBonding,e.BN,e.bs58,e.LitJsSdk,e.uuid,e.nacl,e.util,e.uint8arrays,e.sdk$1,e.sdk,e.Decimal)}(this,(function(e,t,i,n,s,a,r,o,c,l,u,d,m,y,p,g,h,f,P){"use strict";function S(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var M=S(l),K=S(u),v=S(d),b=S(y),A=S(P);
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
function I(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(i[n[s]]=e[n[s]])}return i}function w(e,t,i,n){return new(i||(i=Promise))((function(s,a){function r(e){try{c(n.next(e))}catch(e){a(e)}}function o(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}c((n=n.apply(e,t||[])).next())}))}const T={Text:{text:{}},Html:{html:{}},Gify:{gify:{}},Image:{image:{}},React:{react:{}}},k={Hold:{hold:{}},Burn:{burn:{}},Pay:{pay:{}}},N={Token:{token:{}},NFT:{nft:{}},Native:{native:{}}},C="undefined"==typeof TextEncoder?p.TextEncoder:TextEncoder,O="I am creating an account to use Lit Protocol at {{timestamp}}";function D(e,t){return w(this,void 0,void 0,(function*(){const i=(new Date).toISOString(),n=O.replace("{{timestamp}}",i),s=(new C).encode(n);let a;if(t instanceof Uint8Array)a=b.default.sign.detached(s,t);else try{a=yield t.signMessage(s,"utf8")}catch(e){throw new Error(`Error signing lit message. This may be because you are using a Ledger, which does not support signMessage. ${e}`)}return{sig:g.toString(a,"base16"),derivedVia:"solana.signMessage",signedMessage:n,address:e.toBase58()}}))}class E{constructor(e){this.payer=e}signTransaction(e){return w(this,void 0,void 0,(function*(){return e.partialSign(this.payer),e}))}signAllTransactions(e){return w(this,void 0,void 0,(function*(){return e.map((e=>(e.partialSign(this.payer),e)))}))}get publicKey(){return this.payer.publicKey}}const B=new r.PublicKey("2e1wdyNhUvE76y6yUCvah2KaviavMJYKoRun8acMRBZZ"),_=new r.PublicKey("SHDWyBxihqiCj6YekG2GUr7wqKLeLAMK1gHZck9pL6y");function V(e,t){return r.PublicKey.findProgramAddress([Buffer.from("storage-account"),e.toBytes(),t.toTwos(2).toArrayLike(Buffer,"le",4)],B)}function R(e){const t=e._rpcEndpoint;return t.includes("dev")?"https://ssc-dao.genesysgo.net":t}function x(e,t,i){var n;return w(this,void 0,void 0,(function*(){if(0!=i&&e){t=j(null==e?void 0:e.connection,t);const c=new r.Connection(R(e.connection),"max"),l=new s.AnchorProvider(c,t?new E(t):e.wallet,{}),u=t?t.publicKey:e.wallet.publicKey,d=new f.ShdwDrive(l.connection,l.wallet),[m]=yield V(u,new M.default(0));let y;try{y=yield d.getStorageAccount(m)}catch(e){}let p=0;const g=y&&Number(y.reserved_bytes)-Number(y.current_usage),P=g&&g>i;if(P)y||(p=Math.ceil(2*i/1024));else{let e=Number(g||2*i);for(;e<i;)e+=e;p=Math.ceil(e/1024)}console.log(`Storage currently has ${Number(g||0)}, file size is ${i}, adding ${p} KB`);const S=(P?0:Math.max(1024*p,1))/Math.pow(10,9),K=yield function(e,t,i){return w(this,void 0,void 0,(function*(){const n=yield a.Token.getAssociatedTokenAddress(a.ASSOCIATED_TOKEN_PROGRAM_ID,a.TOKEN_PROGRAM_ID,i,t,!0),s=yield o.getMintInfo(e,i),r=yield e.connection.getAccountInfo(n,"confirmed");return r?o.toNumber(a.u64.fromBuffer(a.AccountLayout.decode(r.data).amount),s):0}))}(l,u,_),v=null===(n=yield c.getAccountInfo(u))||void 0===n?void 0:n.lamports;if(K<S){if(!v)throw new Error("Not enough sol in wallet "+u.toBase58());const e=h.getOrca(l.connection).getPool(h.OrcaPoolConfig.SHDW_SOL),i=e.getTokenB(),n=e.getTokenA(),s=yield e.getQuote(n,new A.default(1.5*S));if(console.log(`Not enough SHDW, buying ${S} SHDW for ~${s.getExpectedOutputAmount().toNumber()} SOL`),s.getExpectedOutputAmount().toU64().gte(new M.default(v)))throw new Error("Not enough sol");const a=yield e.swap(u,i,s.getExpectedOutputAmount(),new A.default(S)),r=a.transaction;r.recentBlockhash=(yield l.connection.getRecentBlockhash()).blockhash,r.feePayer=u;const c=[...a.signers,t].filter(o.truthy);r.sign(...c),yield o.sendAndConfirmWithRetry(l.connection,r.serialize(),{skipPreflight:!0},"max"),yield o.sleep(2e3)}yield d.init(),y&&p&&!P?yield z((()=>d.addStorage(m,p+"KB","v2")),3):y||(yield z((()=>d.createStorageAccount("chat",p+"KB","v2")),3),yield z((()=>d.makeStorageImmutable(m,"v2")),3))}}))}function U(e,t,i,n=5){return w(this,void 0,void 0,(function*(){if(0==t.length)return[];const s=t.reduce(((e,t)=>e+t.size),0);if(yield x(e,i,s),e){const s=(i=j(e.connection,i))?i.publicKey:e.wallet.publicKey,[a]=yield V(s,new M.default(0)),o=new f.ShdwDrive(new r.Connection(R(e.connection),"max"),i?new E(i):e.wallet);yield o.init();return yield z((()=>w(this,void 0,void 0,(function*(){const e=(yield o.uploadMultipleFiles(a,t)).map((e=>e.location));if(e.length!==t.length)throw new Error("Upload failed");return e}))),n)}}))}const W=r.Keypair.fromSecretKey(new Uint8Array([17,83,103,136,230,98,37,214,218,31,168,218,184,30,163,18,164,101,117,232,151,205,200,74,198,52,31,21,234,238,220,182,9,99,203,242,226,192,165,246,188,184,61,204,50,228,30,89,215,145,146,206,179,116,224,158,180,176,27,221,238,77,69,207]));function j(e,t){return e._rpcEndpoint.includes("dev")?W:t}function z(e,t=3){return w(this,void 0,void 0,(function*(){try{return yield e()}catch(i){if(t>0)return console.warn(`Failed tx, retrying up to ${t} more times.`,i),yield o.sleep(1e3),z(e,t-1);throw i}}))}const q=new r.PublicKey("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),L=new n.LocalStorageLRU;class G{constructor(e){this.url=e}setSymKey(e,t){L.set("enc2"+e,t)}getSymKey(e){return L.get("enc2"+e)}getKey(e,t){return`sym-2-${this.url}-${e.toBase58()}-${t}`}setSymKeyToUse(e,t,i){const n=this.getKey(e,t);L.set(n,JSON.stringify(i))}getTimeSinceLastSet(e,t){const i=L.get(this.getKey(e,t));return i?(new Date).valueOf()-JSON.parse(i).timeMillis:null}getSymKeyToUse(e,t){const i=new Date;i.setDate(i.getDate()-1);const n=this.getTimeSinceLastSet(e,t);if(!n)return null;if(n>108e5)return null;const s=L.get(this.getKey(e,t));return s?JSON.parse(s):null}}const F={name:"AES-CBC",length:256};function J(){return w(this,void 0,void 0,(function*(){return yield crypto.subtle.generateKey(F,!0,["encrypt","decrypt"])}))}function $(e){return w(this,void 0,void 0,(function*(){return yield crypto.subtle.importKey("raw",e,F,!0,["encrypt","decrypt"])}))}function H(e){return crypto.subtle.exportKey("raw",e)}var Y;function Z(e){return e.replace(new RegExp("\0","g"),"")}e.MessageType=void 0,function(e){e.Text="text",e.Html="html",e.Gify="gify",e.Image="image",e.React="react"}(e.MessageType||(e.MessageType={})),e.IdentifierType=void 0,(Y=e.IdentifierType||(e.IdentifierType={})).Chat="chat",Y.User="me";class Q extends o.AnchorSdk{constructor({provider:e,program:t,litClient:i,namespacesProgram:n,symKeyStorage:s=new G(e.connection._rpcEndpoint),tokenBondingProgram:a,tokenMetadataProgram:r}){super({provider:e,program:t}),this.conditionVersion=2,this._namespaces=null,this._namespacesPromise=null,this.entryDecoder=(e,t)=>{const i=this.namespacesProgram.coder.accounts.decode("entry",t.data);return Object.assign(Object.assign({},i),{publicKey:e})},this.chatDecoder=(e,t)=>{const i=this.program.coder.accounts.decode("ChatV0",t.data);return Object.assign(Object.assign({},i),{name:Z(i.name),imageUrl:Z(i.imageUrl),metadataUrl:Z(i.metadataUrl),publicKey:e})},this.chatPermissionsDecoder=(e,t)=>{const i=this.program.coder.accounts.decode("ChatPermissionsV0",t.data);return Object.assign(Object.assign({},i),{publicKey:e})},this.delegateWalletDecoder=(e,t)=>{const i=this.program.coder.accounts.decode("DelegateWalletV0",t.data);return Object.assign(Object.assign({},i),{publicKey:e})},this.profileDecoder=(e,t)=>{const i=this.program.coder.accounts.decode("ProfileV0",t.data);return Object.assign(Object.assign({},i),{imageUrl:Z(i.imageUrl),metadataUrl:Z(i.metadataUrl),publicKey:e})},this.settingsDecoder=(e,t)=>{const i=this.program.coder.accounts.decode("SettingsV0",t.data),n=this;return Object.assign(Object.assign({},i),{publicKey:e,getDelegateWalletSeed(){return w(this,void 0,void 0,(function*(){const e=yield n.getSymmetricKey(i.encryptedSymmetricKey,[ie(i.ownerWallet)]);return n.litJsSdk.decryptString(new Blob([n.litJsSdk.uint8arrayFromString(i.encryptedDelegateWallet,"base16")]),e)}))}})},this.caseInsensitiveMarkerDecoder=(e,t)=>{const i=this.program.coder.accounts.decode("CaseInsensitiveMarkerV0",t.data);return Object.assign(Object.assign({},i),{publicKey:e})},this.symKeyFetchCache={},this.namespacesProgram=n,this.authingLit=null;const o=e.connection._rpcEndpoint;o.includes("dev")||o.includes("local")||o.includes("127.0.0.1")?this.chain="solanaDevnet":this.chain="solana",this.litClient=i,this.symKeyStorage=s,this.litJsSdk=v.default,this.tokenBondingProgram=a,this.tokenMetadataProgram=r}get isLitAuthed(){return Boolean(this.litAuthSig)}_litAuth(){return w(this,void 0,void 0,(function*(){const e=L.get("lit-auth-sol-signature");L.get("lit-auth-sol-signature-date");const t=JSON.parse(e);if(this.wallet&&this.wallet.publicKey)if(this.wallet.publicKey.toBase58()!==(null==t?void 0:t.address))try{if(!this.wallet.signMessage)throw new Error("This wallet does not support signMessage. Please use another wallet");this.litAuthSig=yield D(this.wallet.publicKey,this.wallet),L.set("lit-auth-sol-signature",JSON.stringify(this.litAuthSig)),L.set("lit-auth-sol-signature-date",(new Date).valueOf().toString())}finally{this.authingLit=null}else this.litAuthSig=t}))}litAuth(){return w(this,void 0,void 0,(function*(){return yield this.authingLit,this.isLitAuthed||this.authingLit||(this.authingLit=this._litAuth()),this.authingLit}))}getNamespace(e){return w(this,void 0,void 0,(function*(){return yield this.namespacesProgram.account.namespace.fetch(e)}))}static init(e,t=Q.ID,n=c.SplTokenBonding.ID){return w(this,void 0,void 0,(function*(){const a=new s.Program(i.NAMESPACES_IDL,i.NAMESPACES_PROGRAM_ID,e),r=yield s.Program.fetchIdl(t,e),l=new s.Program(r,t,e),u=yield o.SplTokenMetadata.init(e),d=yield c.SplTokenBonding.init(e,n),m=new v.default.LitNodeClient({alertWhenUnauthorized:!1,debug:!1});try{yield m.connect()}catch(e){console.warn(e)}return new this({provider:e,program:l,litClient:m,namespacesProgram:a,tokenBondingProgram:d,tokenMetadataProgram:u})}))}getChat(e){return this.getAccount(e,this.chatDecoder)}getChatPermissions(e){return this.getAccount(e,this.chatPermissionsDecoder)}getProfile(e){return this.getAccount(e,this.profileDecoder)}getSettings(e){return this.getAccount(e,this.settingsDecoder)}getCaseInsensitiveMarker(e){return this.getAccount(e,this.caseInsensitiveMarkerDecoder)}getMessagesFromParts(e,t=!0){const i=e.reduce(((e,t)=>(e[t.id]=e[t.id]||[],e[t.id].push(t),e)),{}),n=Object.values(i).map((e=>this.getMessageFromParts(e,t)));return n.filter(o.truthy).sort(((e,t)=>e.startBlockTime-t.startBlockTime))}_getSymmetricKey(e,t){return w(this,void 0,void 0,(function*(){const i=this.symKeyStorage.getSymKey(e);let n=i?Buffer.from(i,"hex"):void 0;if(!n){yield this.litAuth(),n=yield this.litClient.getEncryptionKey({solRpcConditions:t,toDecrypt:e,chain:this.chain,authSig:this.litAuthSig});const i=Buffer.from(n).toString("hex");this.symKeyStorage.setSymKey(e,i)}return delete this.symKeyFetchCache[e],n}))}getSymmetricKey(e,t){return w(this,void 0,void 0,(function*(){return this.symKeyFetchCache[e]||(this.symKeyFetchCache[e]=this._getSymmetricKey(e,t)),this.symKeyFetchCache[e]}))}getMessageFromParts(e,t=!0){if(0==e.length)return;const i=e.length!==e[0].totalParts;if(t&&i)return;const n=e.sort(((e,t)=>e.currentPart-t.currentPart)).map((e=>e.content)).join(""),s=e[0],{messageType:a,readPermissionAmount:r,chatKey:c,encryptedSymmetricKey:l,referenceMessageId:u,readPermissionKey:d,readPermissionType:m}=s,y=I(s,["messageType","readPermissionAmount","chatKey","encryptedSymmetricKey","referenceMessageId","readPermissionKey","readPermissionType"]);let p;return Object.assign(Object.assign({},y),{complete:!i,referenceMessageId:u,type:a&&Object.keys(a)[0],encryptedSymmetricKey:l,startBlockTime:e[0].blockTime,endBlockTime:e[e.length-1].blockTime,txids:e.map((e=>e.txid)),readPermissionAmount:r,readPermissionKey:d,readPermissionType:m,content:n,chatKey:c,getDecodedMessage:()=>w(this,void 0,void 0,(function*(){if(p)return p;let t;try{const e=yield o.getMintInfo(this.provider,d);t=o.toBN(r,e)}catch(e){t=new M.default(r)}if(l){yield this.litAuth();const i=X(e[0].conditionVersion,d,t,this.chain,m);try{const e=new Blob([this.litJsSdk.uint8arrayFromString(n,"base16")]),t=yield this.getSymmetricKey(l,i);p=JSON.parse(yield this.litJsSdk.decryptString(e,t)),p.decryptedAttachments=[],p.decryptedAttachments.push(...yield Promise.all((p.encryptedAttachments||[]).map((e=>w(this,void 0,void 0,(function*(){const i=yield fetch(e.file||e).then((e=>e.blob())),n=yield this.litJsSdk.decryptFile({symmetricKey:t,file:i});return{file:new Blob([n]),name:e.name||"Attachment"}}))))))}catch(e){console.error("Failed to decode message",e)}}else p=JSON.parse(n);return p})),parts:e})}getMessagePartsFromInflatedTx({chat:e,transaction:t,txid:i,meta:n,blockTime:a,idl:r}){return w(this,void 0,void 0,(function*(){if(null==n?void 0:n.err)return[];const c=t.message.instructions.filter((e=>ae(t.message.accountKeys[e.programIdIndex]).equals(this.programId))),l=yield this.getChat(e);if(r||(r=yield s.Program.fetchIdl(l.postMessageProgramId,this.provider)),!r)throw new Error("Chat only supports programs with published IDLs.");const u=new s.Program(r,l.postMessageProgramId,this.provider).coder.instruction,d=c.filter((e=>ae(t.message.accountKeys[e.programIdIndex]).equals(l.postMessageProgramId))).map((e=>{const i=Buffer.concat([K.default.decode(e.data),Buffer.alloc(1e3)]),{name:n,data:s}=u.decode(i),a=r.instructions.find((e=>e.name==n)),o=a.accounts.findIndex((e=>"sender"===e.name)),c=a.accounts.findIndex((e=>"chat"===e.name));return{data:s,sender:ae(t.message.accountKeys[e.accounts[o]]),chat:ae(t.message.accountKeys[e.accounts[c]]),profile:ae(t.message.accountKeys[e.accounts[2]])}})).filter(o.truthy);return Promise.all(d.map((e=>w(this,void 0,void 0,(function*(){const t=e.data.args;let n=e.sender;if(a&&a<1657043710){n=(yield this.getProfile(e.profile)).ownerWallet}if(!t.readPermissionKey){const i=(yield Q.chatPermissionsKey(e.chat,this.programId))[0],n=yield this.getChatPermissions(i);t.readPermissionKey=null==n?void 0:n.readPermissionKey,t.readPermissionType=null==n?void 0:n.readPermissionType}return Object.assign(Object.assign({},t),{blockTime:a,txid:i,chatKey:e.chat,sender:n})})))))}))}getMessagePartsFromTx({chat:e,txid:t,idl:i}){var n;return w(this,void 0,void 0,(function*(){const s=this.provider.connection,a=yield s.getTransaction(t,{commitment:"confirmed"});return a?(null===(n=a.meta)||void 0===n?void 0:n.err)?[]:this.getMessagePartsFromInflatedTx({chat:e,transaction:a.transaction,txid:t,meta:a.meta,blockTime:a.blockTime,idl:i}):[]}))}static chatKey(e,t=Q.ID){return r.PublicKey.findProgramAddress([Buffer.from("identified-chat","utf-8"),e.toBuffer()],t)}static chatPermissionsKey(e,t=Q.ID){return r.PublicKey.findProgramAddress([Buffer.from("permissions","utf-8"),e.toBuffer()],t)}static caseInsensitiveMarkerKey(e,t,i=Q.ID){return r.PublicKey.findProgramAddress([Buffer.from("case_insensitive","utf-8"),e.toBuffer(),s.utils.bytes.utf8.encode(t.toLowerCase())],i)}static entryKey(e,t){return r.PublicKey.findProgramAddress([s.utils.bytes.utf8.encode(i.ENTRY_SEED),e.toBytes(),s.utils.bytes.utf8.encode(t)],i.NAMESPACES_PROGRAM_ID)}static delegateWalletKey(e,t=Q.ID){return r.PublicKey.findProgramAddress([Buffer.from("delegate-wallet","utf-8"),e.toBuffer()],t)}static profileKey(e,t=Q.ID){return r.PublicKey.findProgramAddress([Buffer.from("wallet_profile","utf-8"),e.toBuffer()],t)}static settingsKey(e,t=Q.ID){return r.PublicKey.findProgramAddress([Buffer.from("settings","utf-8"),e.toBuffer()],t)}static namespacesKey(e=Q.ID){return r.PublicKey.findProgramAddress([Buffer.from("namespaces","utf-8")],e)}initializeNamespacesInstructions(){return w(this,void 0,void 0,(function*(){try{return yield this.getNamespaces(),{instructions:[],signers:[],output:null}}catch(e){}const[t]=yield Q.namespacesKey(),[n,a]=yield r.PublicKey.findProgramAddress([s.utils.bytes.utf8.encode(i.NAMESPACE_SEED),s.utils.bytes.utf8.encode(e.IdentifierType.Chat)],i.NAMESPACES_PROGRAM_ID),[o,c]=yield r.PublicKey.findProgramAddress([s.utils.bytes.utf8.encode(i.NAMESPACE_SEED),s.utils.bytes.utf8.encode(e.IdentifierType.User)],i.NAMESPACES_PROGRAM_ID),l=[];return l.push(yield this.program.instruction.initializeNamespacesV0({chatNamespaceName:e.IdentifierType.Chat,userNamespaceName:e.IdentifierType.User,chatNamespaceBump:a,userNamespaceBump:c},{accounts:{payer:this.wallet.publicKey,namespaces:t,namespacesProgram:i.NAMESPACES_PROGRAM_ID,chatNamespace:n,userNamespace:o,systemProgram:r.SystemProgram.programId}})),{instructions:l,signers:[],output:null}}))}initializeNamespaces(){return w(this,void 0,void 0,(function*(){return this.execute(this.initializeNamespacesInstructions(),this.wallet.publicKey,"confirmed")}))}_getNamespaces(){return w(this,void 0,void 0,(function*(){const e=(yield Q.namespacesKey(this.programId))[0],t=yield this.program.account.namespacesV0.fetch(e);return Object.assign(Object.assign({},t),{publicKey:e,chat:yield this.getNamespace(t.chatNamespace),user:yield this.getNamespace(t.userNamespace)})}))}getNamespaces(){return w(this,void 0,void 0,(function*(){return this._namespaces||(this._namespacesPromise=this._getNamespaces(),this._namespaces=yield this._namespacesPromise),this._namespaces}))}claimIdentifierInstructions({payer:n=this.wallet.publicKey,owner:a=this.wallet.publicKey,identifier:o,type:c}){return w(this,void 0,void 0,(function*(){const l=new r.Transaction,u=r.Keypair.generate();let d=[],m=u.publicKey;const y=yield this.getNamespaces();let p,g;c===e.IdentifierType.Chat?(p=y.chat.name,g=y.chatNamespace):(p=y.user.name,g=y.userNamespace);const[h]=yield Q.entryKey(g,o),f=yield this.namespacesProgram.account.entry.fetchNullable(h);f?(m=f.mint,d=[]):(yield i.withInitNameEntry(l,this.provider.connection,this.provider.wallet,p,o),d.push(u),yield i.withInitNameEntryMint(l,this.provider.connection,this.provider.wallet,p,o,u));const[P]=yield r.PublicKey.findProgramAddress([s.utils.bytes.utf8.encode(i.CLAIM_REQUEST_SEED),g.toBytes(),s.utils.bytes.utf8.encode(o),a.toBytes()],i.NAMESPACES_PROGRAM_ID);(yield this.provider.connection.getAccountInfo(P))||(yield i.withCreateClaimRequest(this.provider.connection,this.provider.wallet,p,o,a,l));const S=l.instructions,M=yield t.Metadata.getPDA(m),K=(yield Q.caseInsensitiveMarkerKey(g,o,this.programId))[0];c!==e.IdentifierType.Chat||(null==f?void 0:f.isClaimed)?(null==f?void 0:f.isClaimed)||S.push(yield this.program.instruction.approveUserIdentifierV0({accounts:{payer:n,caseInsensitiveMarker:K,namespaces:y.publicKey,userNamespace:y.userNamespace,claimRequest:P,entry:h,certificateMintMetadata:M,namespacesProgram:i.NAMESPACES_PROGRAM_ID,tokenMetadataProgram:q,systemProgram:r.SystemProgram.programId}})):S.push(yield this.program.instruction.approveChatIdentifierV0({accounts:{payer:n,caseInsensitiveMarker:K,namespaces:y.publicKey,chatNamespace:y.chatNamespace,claimRequest:P,entry:h,certificateMintMetadata:M,namespacesProgram:i.NAMESPACES_PROGRAM_ID,tokenMetadataProgram:q,systemProgram:r.SystemProgram.programId}}));const v=new r.Transaction;return(null==f?void 0:f.isClaimed)||(yield i.withClaimNameEntry(v,this.provider.connection,Object.assign(Object.assign({},this.provider.wallet),{publicKey:a}),p,o,m,0,a,n)),{instructions:[S,v.instructions],signers:[d,[]],output:{certificateMint:m}}}))}claimIdentifier(e,t){return w(this,void 0,void 0,(function*(){return this.executeBig(this.claimIdentifierInstructions(e),e.payer,t)}))}claimChatAdminInstructions({chat:e,admin:t=this.wallet.publicKey}){var i;return w(this,void 0,void 0,(function*(){const n=yield this.getChat(e);if(n.identifierCertificateMint&&!(null===(i=n.admin)||void 0===i?void 0:i.equals(t))){const i=yield a.Token.getAssociatedTokenAddress(a.ASSOCIATED_TOKEN_PROGRAM_ID,a.TOKEN_PROGRAM_ID,n.identifierCertificateMint,t,!0);return{output:null,signers:[],instructions:[yield this.instruction.claimAdminV0({accounts:{chat:e,identifierCertificateMintAccount:i,ownerWallet:t}})]}}return{output:null,signers:[],instructions:[]}}))}claimAdmin(e,t="confirmed"){return w(this,void 0,void 0,(function*(){return this.execute(this.claimChatAdminInstructions(e),e.admin,t)}))}closeChatInstructions({refund:e=this.wallet.publicKey,chat:t,admin:i=this.wallet.publicKey}){return w(this,void 0,void 0,(function*(){const n=[];n.push(...(yield this.claimChatAdminInstructions({chat:t,admin:i})).instructions);const s=(yield Q.chatPermissionsKey(t))[0];return(yield this.getChatPermissions(s))&&n.push(yield this.instruction.closeChatPermissionsV0({accounts:{refund:e,admin:i,chat:t,chatPermissions:s,systemProgram:r.SystemProgram.programId}})),n.push(yield this.instruction.closeChatV0({accounts:{refund:e,admin:i,chat:t,systemProgram:r.SystemProgram.programId}})),{signers:[],instructions:n,output:null}}))}closeChat(e,t){return w(this,void 0,void 0,(function*(){yield this.execute(this.closeChatInstructions(e),e.refund,t)}))}initializeChatInstructions({payer:i=this.wallet.publicKey,identifierCertificateMint:n,identifier:s,name:c,permissions:l,postMessageProgramId:u=this.programId,imageUrl:d="",metadataUrl:m="",chatKeypair:y,admin:p=this.wallet.publicKey}){return w(this,void 0,void 0,(function*(){const g=[],h=[];if(s){const t=yield this.claimIdentifierInstructions({payer:i,owner:p,identifier:s,type:e.IdentifierType.Chat});n=t.output.certificateMint,g.push(...t.instructions),h.push(...t.signers)}const f=[],P=[];let S,K;if(n){S=(yield Q.chatKey(n,this.programId))[0];const e=yield this.getNamespaces();if(!s){const e=yield t.Metadata.getPDA(n),i=yield new t.Metadata(e,yield this.provider.connection.getAccountInfo(e)),[a]=i.data.data.name.split(".");s=a}const[o]=yield yield Q.entryKey(e.chatNamespace,s),l=yield a.Token.getAssociatedTokenAddress(a.ASSOCIATED_TOKEN_PROGRAM_ID,a.TOKEN_PROGRAM_ID,n,p,!0),y=yield this.instruction.initializeChatV0({name:c,imageUrl:d,metadataUrl:m,postMessageProgramId:u},{accounts:{payer:i,chat:S,namespaces:e.publicKey,entry:o,identifierCertificateMint:n,identifierCertificateMintAccount:l,ownerWallet:p,systemProgram:r.SystemProgram.programId}});f.push(y)}else{S=(y=y||r.Keypair.generate()).publicKey;const e=yield this.instruction.initializeUnidentifiedChatV0({name:c,imageUrl:d,metadataUrl:m,postMessageProgramId:u},p,{accounts:{payer:i,chat:S,systemProgram:r.SystemProgram.programId}});f.push(e),P.push(y)}if(l){let e,t,{readPermissionKey:n,postPermissionKey:s,postPermissionAction:c=k.Hold,postPayDestination:u,postPermissionAmount:d=1,defaultReadPermissionAmount:m=1,readPermissionType:y=N.Token,postPermissionType:g=N.Token}=l;n.equals(a.NATIVE_MINT)&&(y=N.Native),s.equals(a.NATIVE_MINT)&&(g=N.Native);try{const t=yield o.getMintInfo(this.provider,s);e=o.toBN(d,t)}catch(t){e=new M.default(d)}try{const e=yield o.getMintInfo(this.provider,n);t=o.toBN(m,e)}catch(e){t=new M.default(m)}K=(yield Q.chatPermissionsKey(S,this.programId))[0],f.push(yield this.instruction.initializeChatPermissionsV0({defaultReadPermissionAmount:t,postPermissionKey:s,readPermissionKey:n,postPermissionAction:c,postPermissionAmount:e,postPayDestination:u||null,readPermissionType:y,postPermissionType:g},{accounts:{payer:i,chat:S,chatPermissions:K,admin:p,systemProgram:r.SystemProgram.programId}}))}return g.push(f),h.push(P),{output:{chat:S,chatPermissions:K,chatKeypair:y,identifierCertificateMint:n},signers:h,instructions:g}}))}initializeChat(e,t="confirmed"){return w(this,void 0,void 0,(function*(){return this.executeBig(this.initializeChatInstructions(e),e.payer,t)}))}initializeProfileInstructions({payer:e=this.wallet.publicKey,ownerWallet:i=this.wallet.publicKey,identifierCertificateMint:n,identifier:s,imageUrl:o="",metadataUrl:c=""}){return w(this,void 0,void 0,(function*(){const l=[],u=(yield Q.profileKey(i,this.programId))[0],d=yield this.getNamespaces(),m=yield t.Metadata.getPDA(n);if(!s){const e=yield new t.Metadata(m,yield this.provider.connection.getAccountInfo(m)),[i]=e.data.data.name.split(".");s=i}const[y]=yield Q.entryKey(d.userNamespace,s),p=yield a.Token.getAssociatedTokenAddress(a.ASSOCIATED_TOKEN_PROGRAM_ID,a.TOKEN_PROGRAM_ID,n,i,!0);return l.push(yield this.instruction.initializeProfileV0({imageUrl:o,metadataUrl:c},{accounts:{payer:e,walletProfile:u,namespaces:d.publicKey,entry:y,identifierCertificateMint:n,identifierCertificateMintAccount:p,ownerWallet:i,systemProgram:r.SystemProgram.programId}})),{output:{walletProfile:u},instructions:l,signers:[]}}))}initializeProfile(e,t="confirmed"){return w(this,void 0,void 0,(function*(){return this.execute(this.initializeProfileInstructions(e),e.payer,t)}))}initializeSettingsInstructions({payer:e=this.wallet.publicKey,ownerWallet:t=this.wallet.publicKey,settings:i}){return w(this,void 0,void 0,(function*(){const n=[],s=(yield Q.settingsKey(t,this.programId))[0],a=yield J(),o=yield this.litJsSdk.encryptWithSymmetricKey(a,this.litJsSdk.uint8arrayFromString(i.delegateWalletSeed)),c=se(yield o.arrayBuffer());yield this.litAuth();const l={encryptedDelegateWallet:c,encryptedSymmetricKey:this.litJsSdk.uint8arrayToString(yield this.litClient.saveEncryptionKey({solRpcConditions:[ie(t)],symmetricKey:new Uint8Array(yield crypto.subtle.exportKey("raw",a)),authSig:this.litAuthSig,chain:this.chain}),"base16")};return n.push(yield this.instruction.initializeSettingsV0(l,{accounts:{payer:e,settings:s,ownerWallet:t,rent:r.SYSVAR_RENT_PUBKEY,systemProgram:r.SystemProgram.programId}})),{output:{settings:s},instructions:n,signers:[]}}))}initializeSettings(e,t="confirmed"){return w(this,void 0,void 0,(function*(){return this.execute(this.initializeSettingsInstructions(e),e.payer,t)}))}initializeDelegateWalletInstructions({payer:e=this.wallet.publicKey,ownerWallet:t=this.wallet.publicKey,delegateWalletKeypair:i,delegateWallet:n}){return w(this,void 0,void 0,(function*(){i||n||(i=r.Keypair.generate()),n||(n=i.publicKey);const s=(yield Q.delegateWalletKey(n))[0],a=[],c=[i].filter(o.truthy);return a.push(yield this.instruction.initializeDelegateWalletV0({accounts:{delegateWallet:s,payer:e,owner:t,delegate:n,systemProgram:r.SystemProgram.programId}})),{output:{delegateWallet:s,delegateWalletKeypair:i},instructions:a,signers:c}}))}initializeDelegateWallet(e,t="confirmed"){return w(this,void 0,void 0,(function*(){return this.execute(this.initializeDelegateWalletInstructions(e),e.payer,t)}))}sendMessageInstructions({sender:e=this.wallet.publicKey,chat:i,message:n,readPermissionAmount:s,delegateWallet:r,delegateWalletKeypair:c,encrypted:l=!0,nftMint:u,readPermissionKey:d,readPermissionType:y}){return w(this,void 0,void 0,(function*(){const{referenceMessageId:p,type:g}=n,h=I(n,["referenceMessageId","type"]);l&&(yield this.litAuth());let{fileAttachments:f}=h,P=I(h,["fileAttachments"]);const S=(yield Q.chatPermissionsKey(i,this.programId))[0],K=yield this.getChatPermissions(S);let v;try{const e=yield o.getMintInfo(this.provider,K.readPermissionKey);v=o.toBN(s||K.defaultReadPermissionAmount,e)}catch(e){v=new M.default(s||K.defaultReadPermissionAmount)}const b=X(this.conditionVersion,K.readPermissionKey,v,this.chain,K.readPermissionType),A=this.symKeyStorage.getSymKeyToUse(K.readPermissionKey,v.toNumber());let k,N,C;if(l&&(k=A?yield $(Buffer.from(A.symKey,"hex")):yield J()),f&&l&&(f=yield Promise.all(f.map((e=>w(this,void 0,void 0,(function*(){const t=yield this.litJsSdk.encryptWithSymmetricKey(k,yield e.file.arrayBuffer());return{file:new File([t],e.file.name+".encrypted"),name:e.name}})))))),f){let e;l?(P.encryptedAttachments=P.encryptedAttachments||[],e=P.encryptedAttachments):(P.attachments=P.attachments||[],e=P.attachments);const t=((yield U(this.provider,f.map((e=>e.file)),c))||[]).filter(o.truthy);if(t.length!=f.length)throw new Error("Failed to upload all files");e.push(...t.map(((e,t)=>({file:e,name:f[t].name}))))}if(l){const e=yield this.litJsSdk.encryptWithSymmetricKey(k,this.litJsSdk.uint8arrayFromString(JSON.stringify(P)));C=se(yield e.arrayBuffer()),A?N=A.encryptedSymKey:(N=this.litJsSdk.uint8arrayToString(yield this.litClient.saveEncryptionKey({solRpcConditions:b,symmetricKey:new Uint8Array(yield crypto.subtle.exportKey("raw",k)),authSig:this.litAuthSig,chain:this.chain}),"base16"),this.symKeyStorage.setSymKeyToUse(K.readPermissionKey,v.toNumber(),{symKey:Buffer.from(yield H(k)).toString("hex"),encryptedSymKey:N,timeMillis:(new Date).valueOf()}))}else N="",C=JSON.stringify(h);const O=yield a.Token.getAssociatedTokenAddress(a.ASSOCIATED_TOKEN_PROGRAM_ID,a.TOKEN_PROGRAM_ID,u||K.postPermissionKey,e,!0),D=[];u&&D.push({pubkey:yield t.Metadata.getPDA(u),isWritable:!1,isSigner:!1}),(r||c)&&(r||(r=c.publicKey),D.push({pubkey:(yield Q.delegateWalletKey(r,this.programId))[0],isWritable:!1,isSigner:!1}));const E=C.length,B=Math.ceil(E/352),_=[],V=[],R=m.v4(),x=(null==K?void 0:K.postPermissionKey.equals(a.NATIVE_MINT))?this.instruction.sendNativeMessageV0:this.instruction.sendTokenMessageV0;for(let t=0;t<B;t++){const n=[];n.push(yield x({conditionVersion:this.conditionVersion,id:R,content:C.slice(352*t,352*(t+1)),encryptedSymmetricKey:N,readPermissionAmount:v,readPermissionType:y||K.readPermissionType,readPermissionKey:d||K.readPermissionKey,totalParts:B,currentPart:t,messageType:T[(W=g,W.charAt(0).toUpperCase()+W.slice(1))],referenceMessageId:p||null},{accounts:{chat:i,chatPermissions:S,sender:e,signer:r||e,postPermissionAccount:O,postPermissionMint:u||K.postPermissionKey,tokenProgram:a.TOKEN_PROGRAM_ID},remainingAccounts:D})),_.push(n),V.push([c].filter(o.truthy))}var W;return{instructions:_,output:{messageId:R},signers:V}}))}sendMessage(e,t="confirmed"){return w(this,void 0,void 0,(function*(){return this.executeBig(this.sendMessageInstructions(e),e.payer,t)}))}createMetadataForBondingInstructions({metadataUpdateAuthority:e=this.provider.wallet.publicKey,metadata:t,targetMintKeypair:i=r.Keypair.generate(),decimals:n}){return w(this,void 0,void 0,(function*(){const s=i.publicKey,r=[],l=[];r.push(...yield o.createMintInstructions(this.tokenBondingProgram.provider,this.provider.wallet.publicKey,s,n)),l.push(i);const{instructions:u,signers:d,output:m}=yield this.tokenMetadataProgram.createMetadataInstructions({data:t,mint:s,mintAuthority:this.provider.wallet.publicKey,authority:e});return r.push(...u),l.push(...d),r.push(a.Token.createSetAuthorityInstruction(a.TOKEN_PROGRAM_ID,s,(yield c.SplTokenBonding.tokenBondingKey(s))[0],"MintTokens",this.provider.wallet.publicKey,[])),{instructions:r,signers:l,output:Object.assign(Object.assign({},m),{mint:s})}}))}}function X(e,t,i,n,s){if(0===e)return[te(t,i,n)];if(1===e)return[ee(t,i,n),{operator:"or"},te(t,i,n)];const a=Object.keys(s)[0];return"token"===a?[te(t,i,n)]:"native"==a?[ne(t,i,n)]:[ee(t,i,n)]}function ee(e,t,i){return{method:"balanceOfMetaplexCollection",params:[e.toBase58()],chain:i,returnValueTest:{key:"",comparator:">=",value:t.toString(10)}}}function te(e,t,i){return{method:"balanceOfToken",params:[e.toBase58()],chain:i,returnValueTest:{key:"$.amount",comparator:">=",value:t.toString(10)}}}function ie(e){return{method:"",params:[":userAddress"],chain:"solana",returnValueTest:{key:"",comparator:"=",value:e.toBase58()}}}function ne(e,t,i){return{method:"getBalance",params:[e.toBase58()],chain:i,returnValueTest:{key:"",comparator:">=",value:t.toString(10)}}}function se(e){return[...new Uint8Array(e)].map((e=>e.toString(16).padStart(2,"0"))).join("")}function ae(e){return"string"==typeof e?new r.PublicKey(e):e}Q.ID=new r.PublicKey("chatGL6yNgZT2Z3BeMYGcgdMpcBKdmxko4C5UhEX4To"),e.AUTH_SIGNATURE_BODY=O,e.ChatIDLJson={version:"3.9.2",name:"chat",instructions:[{name:"initializeNamespacesV0",accounts:[{name:"payer",isMut:!0,isSigner:!0},{name:"namespaces",isMut:!0,isSigner:!1},{name:"namespacesProgram",isMut:!1,isSigner:!1},{name:"chatNamespace",isMut:!0,isSigner:!1},{name:"userNamespace",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"args",type:{defined:"InitializeNamespacesArgsV0"}}]},{name:"claimAdminV0",accounts:[{name:"chat",isMut:!1,isSigner:!1},{name:"identifierCertificateMintAccount",isMut:!1,isSigner:!1},{name:"ownerWallet",isMut:!1,isSigner:!0}],args:[]},{name:"initializeChatV0",accounts:[{name:"payer",isMut:!0,isSigner:!0},{name:"chat",isMut:!0,isSigner:!1},{name:"namespaces",isMut:!1,isSigner:!1},{name:"entry",isMut:!1,isSigner:!1},{name:"identifierCertificateMint",isMut:!1,isSigner:!1},{name:"identifierCertificateMintAccount",isMut:!1,isSigner:!1},{name:"ownerWallet",isMut:!1,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"args",type:{defined:"InitializeChatArgsV0"}}]},{name:"initializeUnidentifiedChatV0",accounts:[{name:"payer",isMut:!0,isSigner:!0},{name:"chat",isMut:!0,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"args",type:{defined:"InitializeChatArgsV0"}},{name:"admin",type:{option:"publicKey"}}]},{name:"closeChatV0",accounts:[{name:"refund",isMut:!0,isSigner:!1},{name:"chat",isMut:!0,isSigner:!1},{name:"admin",isMut:!1,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"closeChatPermissionsV0",accounts:[{name:"refund",isMut:!0,isSigner:!1},{name:"chat",isMut:!1,isSigner:!1},{name:"chatPermissions",isMut:!0,isSigner:!1},{name:"admin",isMut:!1,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"initializeChatPermissionsV0",accounts:[{name:"payer",isMut:!0,isSigner:!0},{name:"chat",isMut:!1,isSigner:!1},{name:"chatPermissions",isMut:!0,isSigner:!1},{name:"admin",isMut:!1,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"args",type:{defined:"InitializeChatPermissionsArgsV0"}}]},{name:"initializeSettingsV0",accounts:[{name:"payer",isMut:!0,isSigner:!0},{name:"settings",isMut:!0,isSigner:!1},{name:"ownerWallet",isMut:!1,isSigner:!0},{name:"rent",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"args",type:{defined:"InitializeSettingsArgsV0"}}]},{name:"initializeProfileV0",accounts:[{name:"payer",isMut:!0,isSigner:!0},{name:"walletProfile",isMut:!0,isSigner:!1},{name:"namespaces",isMut:!1,isSigner:!1},{name:"entry",isMut:!1,isSigner:!1},{name:"identifierCertificateMint",isMut:!1,isSigner:!1},{name:"identifierCertificateMintAccount",isMut:!1,isSigner:!1},{name:"ownerWallet",isMut:!1,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"args",type:{defined:"InitializeProfileArgsV0"}}]},{name:"initializeDelegateWalletV0",accounts:[{name:"payer",isMut:!0,isSigner:!0},{name:"delegateWallet",isMut:!0,isSigner:!1},{name:"owner",isMut:!1,isSigner:!0},{name:"delegate",isMut:!1,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"sendTokenMessageV0",accounts:[{name:"chat",isMut:!1,isSigner:!1},{name:"chatPermissions",isMut:!1,isSigner:!1},{name:"sender",isMut:!1,isSigner:!1},{name:"signer",isMut:!1,isSigner:!0},{name:"postPermissionAccount",isMut:!0,isSigner:!1},{name:"postPermissionMint",isMut:!0,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[{name:"args",type:{defined:"MessagePartV0"}}]},{name:"sendNativeMessageV0",accounts:[{name:"chat",isMut:!1,isSigner:!1},{name:"chatPermissions",isMut:!1,isSigner:!1},{name:"sender",isMut:!1,isSigner:!1},{name:"signer",isMut:!1,isSigner:!0}],args:[{name:"args",type:{defined:"MessagePartV0"}}]},{name:"approveChatIdentifierV0",accounts:[{name:"payer",isMut:!0,isSigner:!0},{name:"namespaces",isMut:!1,isSigner:!1},{name:"chatNamespace",isMut:!1,isSigner:!1},{name:"claimRequest",isMut:!0,isSigner:!1},{name:"entry",isMut:!0,isSigner:!1},{name:"caseInsensitiveMarker",isMut:!0,isSigner:!1},{name:"certificateMintMetadata",isMut:!0,isSigner:!1},{name:"namespacesProgram",isMut:!1,isSigner:!1},{name:"tokenMetadataProgram",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"approveUserIdentifierV0",accounts:[{name:"payer",isMut:!0,isSigner:!0},{name:"namespaces",isMut:!1,isSigner:!1},{name:"userNamespace",isMut:!1,isSigner:!1},{name:"claimRequest",isMut:!0,isSigner:!1},{name:"entry",isMut:!0,isSigner:!1},{name:"caseInsensitiveMarker",isMut:!0,isSigner:!1},{name:"certificateMintMetadata",isMut:!0,isSigner:!1},{name:"namespacesProgram",isMut:!1,isSigner:!1},{name:"tokenMetadataProgram",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]}],accounts:[{name:"NamespacesV0",type:{kind:"struct",fields:[{name:"bump",type:"u8"},{name:"chatNamespace",type:"publicKey"},{name:"userNamespace",type:"publicKey"}]}},{name:"ChatV0",type:{kind:"struct",fields:[{name:"bump",type:"u8"},{name:"chatType",type:{defined:"ChatType"}},{name:"name",type:"string"},{name:"imageUrl",type:"string"},{name:"metadataUrl",type:"string"},{name:"postMessageProgramId",type:"publicKey"},{name:"admin",type:{option:"publicKey"}},{name:"identifierCertificateMint",type:{option:"publicKey"}}]}},{name:"ChatPermissionsV0",type:{kind:"struct",fields:[{name:"bump",type:"u8"},{name:"chat",type:"publicKey"},{name:"postPermissionType",type:{defined:"PermissionType"}},{name:"readPermissionType",type:{defined:"PermissionType"}},{name:"postPermissionKey",type:"publicKey"},{name:"readPermissionKey",type:"publicKey"},{name:"postPermissionAmount",type:"u64"},{name:"defaultReadPermissionAmount",type:"u64"},{name:"postPermissionAction",type:{defined:"PostAction"}},{name:"postPayDestination",type:{option:"publicKey"}}]}},{name:"ProfileV0",type:{kind:"struct",fields:[{name:"bump",type:"u8"},{name:"ownerWallet",type:"publicKey"},{name:"identifierCertificateMint",type:"publicKey"},{name:"imageUrl",type:"string"},{name:"metadataUrl",type:"string"}]}},{name:"SettingsV0",type:{kind:"struct",fields:[{name:"bump",type:"u8"},{name:"ownerWallet",type:"publicKey"},{name:"encryptedDelegateWallet",type:"string"},{name:"encryptedSymmetricKey",type:"string"}]}},{name:"DelegateWalletV0",type:{kind:"struct",fields:[{name:"ownerWallet",type:"publicKey"},{name:"delegateWallet",type:"publicKey"}]}},{name:"CaseInsensitiveMarkerV0",type:{kind:"struct",fields:[{name:"bump",type:"u8"},{name:"certificateMint",type:"publicKey"}]}}],types:[{name:"InitializeChatArgsV0",type:{kind:"struct",fields:[{name:"name",type:"string"},{name:"imageUrl",type:"string"},{name:"metadataUrl",type:"string"},{name:"postMessageProgramId",type:"publicKey"}]}},{name:"InitializeChatPermissionsArgsV0",type:{kind:"struct",fields:[{name:"postPermissionKey",type:"publicKey"},{name:"readPermissionKey",type:"publicKey"},{name:"postPermissionAmount",type:"u64"},{name:"defaultReadPermissionAmount",type:"u64"},{name:"postPermissionAction",type:{defined:"PostAction"}},{name:"postPermissionType",type:{defined:"PermissionType"}},{name:"readPermissionType",type:{defined:"PermissionType"}},{name:"postPayDestination",type:{option:"publicKey"}}]}},{name:"InitializeNamespacesArgsV0",type:{kind:"struct",fields:[{name:"chatNamespaceName",type:"string"},{name:"userNamespaceName",type:"string"},{name:"chatNamespaceBump",type:"u8"},{name:"userNamespaceBump",type:"u8"}]}},{name:"InitializeProfileArgsV0",type:{kind:"struct",fields:[{name:"imageUrl",type:"string"},{name:"metadataUrl",type:"string"}]}},{name:"InitializeSettingsArgsV0",type:{kind:"struct",fields:[{name:"encryptedDelegateWallet",type:"string"},{name:"encryptedSymmetricKey",type:"string"}]}},{name:"MessagePartV0",type:{kind:"struct",fields:[{name:"id",type:"string"},{name:"totalParts",type:"u16"},{name:"currentPart",type:"u16"},{name:"readPermissionAmount",type:"u64"},{name:"encryptedSymmetricKey",type:"string"},{name:"content",type:"string"},{name:"conditionVersion",type:"u8"},{name:"messageType",type:{defined:"MessageType"}},{name:"referenceMessageId",type:{option:"string"}},{name:"readPermissionKey",type:"publicKey"},{name:"readPermissionType",type:{defined:"PermissionType"}}]}},{name:"MessageType",type:{kind:"enum",variants:[{name:"Text"},{name:"Html"},{name:"Gify"},{name:"Image"},{name:"React"}]}},{name:"PostAction",type:{kind:"enum",variants:[{name:"Hold"},{name:"Burn"},{name:"Pay"}]}},{name:"PermissionType",type:{kind:"enum",variants:[{name:"Token"},{name:"NFT"},{name:"Native"}]}},{name:"ChatType",type:{kind:"enum",variants:[{name:"Identified"},{name:"Unidentified"}]}}],events:[{name:"MessagePartEventV0",fields:[{name:"chat",type:"publicKey",index:!1},{name:"sender",type:"publicKey",index:!1},{name:"signer",type:"publicKey",index:!1},{name:"message",type:{defined:"MessagePartV0"},index:!1}]}],errors:[{code:6e3,name:"InvalidStringLength",msg:"Invalid string length, your string was likely too long"},{code:6001,name:"PermissionDenied",msg:"You do not have enough tokens to post here"},{code:6002,name:"StringNotAlphanumeric",msg:"The string was not alphanumeric"},{code:6003,name:"IncorrectSender",msg:"The sender must either be a delegate or owner wallet"},{code:6004,name:"InvalidPermissionType",msg:"The permission type was invalid"},{code:6005,name:"InvalidDataIncrease",msg:"The realloc increase was too large"}]},e.ChatSdk=Q,e.ChatType={Identified:{identified:{}},Unidentified:{unidentified:{}}},e.LocalSymKeyStorage=G,e.PermissionType=N,e.PostAction=k,e.RawMessageType=T,e.exportSymmetricKey=H,e.getAuthSig=D,e.importSymmetricKey=$,e.initStorageIfNeeded=x,e.randomizeFileName=function(e){const t=e.name.split(".").pop(),i=Math.random().toString(32).slice(2)+(t?`.${t}`:"");Object.defineProperty(e,"name",{writable:!0,value:i})},e.uploadFiles=U,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=index.umd.js.map
